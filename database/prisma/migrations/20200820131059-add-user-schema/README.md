# Migration `20200820131059-add-user-schema`

This migration has been generated by Christopher Jeffrey Obando at 8/20/2020, 9:10:59 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "universalstore"."UserProfilePhoto" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"userId" text   NOT NULL ,
"size512" text   NOT NULL ,
"size256" text   NOT NULL ,
"size128" text   NOT NULL ,
"size64" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "universalstore"."User" (
"id" text   NOT NULL ,
"sessionId" text   NOT NULL ,
"phoneNumber" text   NOT NULL ,
"firstName" text   ,
"lastName" text   ,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "UserProfilePhoto.userId_unique" ON "universalstore"."UserProfilePhoto"("userId")

CREATE UNIQUE INDEX "User.sessionId_unique" ON "universalstore"."User"("sessionId")

CREATE UNIQUE INDEX "User.phoneNumber_unique" ON "universalstore"."User"("phoneNumber")

ALTER TABLE "universalstore"."UserProfilePhoto" ADD FOREIGN KEY ("userId")REFERENCES "universalstore"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200820131059-add-user-schema
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,37 @@
+// This is your Prisma schema file,
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+  output   = "../../node_modules/.prisma/client"
+}
+
+
+model UserProfilePhoto {
+  // Metadata
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  // Associated user
+  user      User     @relation(fields: [userId], references: [id])
+  userId    String   @unique
+  // URL for each size of the profile photo
+  size512   String
+  size256   String
+  size128   String
+  size64    String
+}
+
+model User {
+  id                String                         @default(cuid()) @id
+  sessionId         String                         @unique
+  phoneNumber       String                         @unique
+  firstName         String?
+  lastName          String?
+  // Linked resources
+  profilePhoto      UserProfilePhoto?
+}
```


